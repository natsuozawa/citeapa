/**
* @fileoverview minified from app.js
* @author Natsu Ozawa
* @license MIT
* any issues should be referred to the author via Github.
*/
'use strict';var _typeof='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(b){return typeof b}:function(b){return b&&'function'==typeof Symbol&&b.constructor===Symbol&&b!==Symbol.prototype?'symbol':typeof b},Format={addPeriod:function addPeriod(b){return'.'!==b.slice(-1)&&0<b.length?b+'.':b},checkCapitalization:function checkCapitalization(b){return b?b.slice(0,1).toUpperCase()+b.slice(1):b},italicize:function italicize(b){return b?'<i>'+b+'</i>':b},parenthesize:function parenthesize(b){return b?'('+b+')':b},bracketize:function bracketize(b){return b?'['+b+']':b},ampersand:function ampersand(b){return 1<b.length&&(b[b.length-1]='& '+b[b.length-1]),b}},Dev={or:function or(b,e){return-1!==e.indexOf(b)}},Tools=Object.assign(Format,Dev,{addContributor:function addContributor(b,e,f,g){var h=[];return b=Format.checkCapitalization(b),e?(h.push(b+','),h.push(e+'.')):h.push(b),e&&f&&h.push(f+'.'),e&&g&&(h[h.length-1]+=',',h.push(g)),h.join(' ')},addEditorOrTranslator:function addEditorOrTranslator(b,e,f,g){var h=[];return e&&h.push(e+'.'),f&&h.push(f+'.'),h.push(Format.checkCapitalization(b)),g&&h.push(g),h.join(' ')},validateNumber:function validateNumber(b){var e=/^\d+$/;return e.test(b)},validateRange:function validateRange(b){var e=/^\d+-\d+$/;return!!this.validateNumber(b)||!!e.test(b)&&function f(g){var h=g.split('-');return 0<h[1]-h[0]}(b)},modifyContributors:function modifyContributors(b){return 1<b.length&&(b[b.length-1]='& '+b[b.length-1]),b},modifyAuthors:function modifyAuthors(b){var e=b.slice();return 8<=e.length?(e.splice(6,e.length-7),e[6]='... '+e[6]):Format.modifyContributors(e),e}}),Preset=function(b){this.type='',this.subtype='',this.format='',b?(this.other='newspaper',this.contributor=[],this.stateRadio=!0,this.doiRadio=!0):(this.author=[],this.editor=[],this.translator=[]),this.sectionTitle='',this.sourceTitle='',this.periodical='',this.date='n.d.',this.publisher='',this.doi='',this.url='',this.vol='',this.issue='',this.ed='',this.pp='',this.reportNo='',this.retrieval='',this.ebook='',this.website='',this.annotation=''};Preset.prototype.validateYear=function(b){var e=new Date;return!(e.getFullYear()<parseInt(b))&&Tools.validateNumber(b)},Preset.prototype.validateDay=function(b,e){return 0>=e||31<e||'February'===b&&29<e||Tools.or(b,['Spring','Summer','Fall','Winter'])?!1:Tools.or(b,['April','June','September','November'])&&30<e?!1:Tools.validateNumber(e)},Preset.prototype.addAuthor=function(b,e,f,g){this.author.push(Tools.addContributor(b,e,f,g))},Preset.prototype.addEditor=function(b,e,f,g){this.editor.push([b,e,f,g])},Preset.prototype.addTranslator=function(b,e,f,g){this.translator.push([b,e,f,g])};var Errors={general:'Error 1000: There was an error with your request. Please retry.',notSupported:'Error 1001: This format is not supported yet. Please select another.',secondAdvance:'Error 1501: Advance releases are only published digitally. Please select "digital" as the format.',secondWiki:'Error 1502: Only digital versions change over time.',contributorType:'Error 1601: The selected contributor type is not available for the specified publication category.',contributorLast:'Error 1611: The last name of the highlighted contributor is missing.',contributorFirst:'Error 1612: The first name of the highlighted contributor is missing.',dateInvalidDay:'Error 1701: The entered day is invalid.',dateInvalidYear:'Error 1702: The entered year is invalid.',dateNoMonth:'Error 1711: The entry is missing the month.',dateNoYear:'Error 1712: The entry is missing the year.',dateNoTitle:'Error 1721: The entry is missing a title.',publisherIncomplete:'Error 1801: The publisher information is incomplete. Please make sure to fill out all fields.',publisherInvalidState:'Error 1802: The state entered is invalid. Please make sure to use the correct abbreviation.',doiUrlMissing:'Error 1811: The doi or url field is empty.',urlMissing:'Error 1821: The url field is empty.',viepInvalidPages:'Error 1831: The page(s) entered is/are invalid.',viepInvalidNumber:'Error 1832: The information entered for the volume/issue field must be a number.',viepNoIssue:'Error 1841: The issue field is empty.',viepNoVol:'Error 1842: The volume field is empty.',viepNoEd:'Error 1843: The edition field is empty.',viepNoPages:'Error 1844: The pages field is empty.',ebookEditionMissing:'Error 1901: The ebook edition field is empty.',copyUnsuccessful:'Error 1002: Copy was unsuccessful. Please check your browser version and settings.'},App=new Preset,CreateComponents=function(b){if(this.editor='',0<b.editor.length&&'chapter'!==b.subtype?(b.editor=b.editor.map(function(g){return Tools.addContributor(g[0],g[1],g[2],g[3])}),1===b.editor.length?b.editor[0]+=' (Ed.)':1<b.editor.length&&(b.editor[b.editor.length-1]+=' (Eds.)'),b.contributor=Tools.modifyAuthors(b.author.concat(b.editor)),this.contributor=b.contributor.join(', ')):(b.contributor=Tools.modifyAuthors(b.author),this.contributor=b.contributor.join(', '),0<b.editor.length&&(b.editor=b.editor.map(function(g){return Tools.addEditorOrTranslator(g[0],g[1],g[2],g[3])}),b.editor=Tools.ampersand(b.editor),1===b.editor.length?b.editor[0]+=' (Ed.)':1<b.editor.length&&(b.editor[b.editor.length-1]+=' (Eds.)'),this.editor=b.editor.join(', '))),this.translator='',0<b.translator.length&&(b.translator=b.translator.map(function(g){return Tools.addEditorOrTranslator(g[0],g[1],g[2],g[3])}),b.translator=Tools.ampersand(b.translator),b.translator[b.translator.length-1]+=', Trans.',this.translator=2<b.translator.length?b.translator.join(', '):b.translator.join(' '),this.translator=Tools.parenthesize(this.translator)),this.date=Tools.parenthesize(b.date),this.section=Tools.checkCapitalization(b.sectionTitle),this.source=Tools.checkCapitalization(b.sourceTitle),('book'===b.type||'reference'===b.type||'report'===b.type)&&(this.source=Tools.italicize(this.source)),this.periodical=Tools.italicize(Tools.checkCapitalization(b.periodical)),this.publication='',Tools.or(b.type,['journal','magazine','newspaper'])){var e='';b.vol&&(e+=', '+Tools.italicize(b.vol)),b.issue&&(e+=Tools.parenthesize(b.issue)),'newspaper'===b.type?-1===b.pp.indexOf('-')?b.pp&&(e+=', p. '+b.pp):e+=', pp. '+b.pp:b.pp&&(e+=', '+b.pp),this.publication=e}else if('book'===b.type||'reference'===b.type){var f=[];b.ed&&f.push(b.ed+' ed.'),b.vol&&f.push('Vol. '+b.vol),-1===b.pp.indexOf('-')?b.pp&&f.push('p. '+b.pp):f.push('pp. '+b.pp),0<f.length&&(f=Tools.parenthesize(f.join(', '))),this.publication=0<f.length?f:''}else'report'===b.type&&b.reportNo&&(this.publication=Tools.parenthesize(b.reportNo));this.publish='','print'===b.format?Tools.or(b.type,['book','reference','report'])&&(this.publish=Tools.checkCapitalization(Tools.addPeriod(b.publisher))):b.doi?this.publish='doi: '+b.doi:b.url&&(b.retrieval?this.publish='Retrieved '+b.retrieval+', from '+b.url:b.website?this.publish='Retrieved from '+b.website+' website: '+b.url:'abstract'===b.subtype?this.publish='Abstract retrieved from '+b.url:this.publish='Retrieved from '+b.url),this.tag='','ebook'===b.format?this.tag=Tools.bracketize(b.ebook):'sp-issue'===b.subtype?this.tag='[Special issue]':'sp-section'===b.subtype?this.tag='[Special section]':'abstract'===b.subtype&&0>=b.url.length&&(this.tag='[Abstract]'),this.annotations=b.annotation};function buildCitation(b,e){var f=[];b.tag&&(b.source+=' '+b.tag);var g=b.translator?b.section+' '+b.translator:b.section;g=Tools.addPeriod(g);var h=Tools.or(e.type,['book','reference','report'])&&b.publication?b.source+' '+b.publication:b.source;if(h=Tools.addPeriod(h),0<b.contributor.length?f.push(b.contributor):0<b.section.length?f.push(g):f.push(h),f[0]=Tools.addPeriod(f[0]),f.push(Tools.addPeriod(b.date)),('book'===e.type||'reference'===e.type)&&'chapter'===e.subtype){f[0]!==g&&f.push(g);var j='In ';b.editor&&(j+=b.editor+', '),j+=b.source,b.publication&&(j+=' '+b.publication),f.push(Tools.addPeriod(j))}else f[0]===h?b.translator&&f.push(Tools.addPeriod(b.translator)):(b.translator&&(h=b.source+' '+b.translator,console.log(b.publication),b.publication&&(h+=' '+b.publication),h=Tools.addPeriod(h)),f.push(h)),Tools.or(e.type,['journal','magazine','newspaper'])&&f.push(Tools.addPeriod(b.periodical+b.publication));return'advance'===e.subtype&&f.push('Advance online publication.'),f.push(b.publish),b.annotations&&f.push(b.annotations),f.join(' ')}function createCitation(){var b=JSON.parse(JSON.stringify(App)),e=new CreateComponents(b);return buildCitation(e,b)}var beforeInfo='#start',beforeSecond='#select',beforeAnnotation='#publication';$(document).ready(function(){function b(){$('input[type="text"], textarea').val(''),$('#other select').val('newspaper'),$('#contributor select').val('author'),$('#title-date select').val('n.d.'),$('#contributor .input-block').remove(),g.addFirstContributor(),k.setToday(),App=new Preset}var e={to:function to(s){$('.page:visible').hide(),$(s).show(),o.setPage(s)}},f={log:function log(){var s=0<arguments.length&&void 0!==arguments[0]?arguments[0]:App.type,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:App.subtype,u=2<arguments.length&&void 0!==arguments[2]?arguments[2]:App.format;return Tools.or(s,['newspaper','magazine','journal','reference','report'])&&(u=$('#print-digital :checked').val()),'journal'===s&&(t=$('#journal :checked').val()),'book'===s&&(u=$('#print-ebook-online :checked').val(),t=$('#chapter-entire :checked').val()),('reference'===s||'webpage'===s)&&(t=$('#wiki :checked').val()),'webpage'===s&&(u='web'),{subtype:t,format:u}},init:function init(){var s=0<arguments.length&&arguments[0]!==void 0?arguments[0]:App.type;'newspaper'===s?$('#second #print-digital').show():'magazine'===s?$('#second #print-digital').show():'journal'===s?($('#second #print-digital').show(),$('#second #journal').show(),$('#second .error-message').html('Advance releases are only published digitally.')):'book'===s?($('#second #print-ebook-online').show(),$('#second #chapter-entire').show()):'reference'===s?($('#second #print-digital').show(),$('#second #wiki').show()):'webpage'===s?$('#second #wiki').show():'report'===s?$('#second #print-digital').show():(console.error(Errors.notSupported),e.to(beforeSecond),App.type='',alert('Sorry, this format is not supported yet'))},resetWarnings:function resetWarnings(){$('#second .error-message').css('visibility','hidden')},default:function _default(){$('#second .entry').hide()},deinit:function deinit(){this.default(),this.resetWarnings()},verify:function verify(){var s=0<arguments.length&&void 0!==arguments[0]?arguments[0]:App.type;this.resetWarnings();var t=!0;return'journal'===s&&'print'===$('#print-digital :checked').val()&&'advance'===$('#journal :checked').val()&&(t=!1,console.error(Errors.secondAdvance)),'reference'===s&&'print'===$('#print-digital :checked').val()&&'change-true'===$('#wiki :checked').val()&&(t=!1,console.error(Errors.secondWiki)),t},undo:function undo(){App.format='',App.subtype=''}},g={log:function log(){var s=[];return $('#contributor .input-block').each(function(){var t={type:$(this).find('select :selected').val(),last:$(this).find('.last').val(),first:$(this).find('.first').val(),middle:$(this).find('.middle').val(),suffix:$(this).find('.suffix').val()};s.push(t)}),s},add:function add(){var s=this.log();s.forEach(function(t){t.last&&('author'===t.type?App.addAuthor(t.last,t.first,t.middle,t.suffix):'editor'===t.type?App.addEditor(t.last,t.first,t.middle,t.suffix):'translator'===t.type&&App.addTranslator(t.last,t.first,t.middle,t.suffix))})},visibleContributorOptions:[],showOptionsBasedOnType:function showOptionsBasedOnType(){var s=0<arguments.length&&arguments[0]!==void 0?arguments[0]:App.type,t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:App.subtype;'book'===s||'reference'===s?($('#contributor option').show(),this.visibleContributorOptions=['author','editor','translator']):'journal'===s&&('sp-issue'===t||'sp-section'===t)?($('#contributor .author, #contributor .editor').show(),this.visibleContributorOptions=['author','editor']):Tools.or(s,['newspaper','magazine','webpage','report','journal'])&&($('#contributor .author').show(),this.visibleContributorOptions=['author'])},init:function init(){this.showOptionsBasedOnType()},addFirstContributor:function addFirstContributor(){var s=0<arguments.length&&arguments[0]!==void 0?arguments[0]:'author',t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:'',u=2<arguments.length&&arguments[2]!==void 0?arguments[2]:'',w=3<arguments.length&&arguments[3]!==void 0?arguments[3]:'',x=4<arguments.length&&arguments[4]!==void 0?arguments[4]:'';$('#contributor .block').append('\n        <div class="input-block">\n          <div>\n            <select name="type">\n              <option class= "author" value="author">Author</option>\n              <option class= "editor" value="editor">Editor</option>\n              <option class= "translator" value="translator">Translator</option>\n            </select>\n          </div>\n          <div>\n            <label>F.I.</label>\n            <input class="first" size="1" maxlength="1" type="text" value="'+t+'">\n          </div>\n          <div>\n            <label>M.I.</label>\n            <input class="middle" size="1" maxlength="1" type="text" value="'+u+'">\n          </div>\n          <div>\n            <label>Last Name</label>\n            <input class="last" type="text" value="'+w+'">\n          </div>\n          <div>\n            <label>Suffix</label>\n            <input class="suffix" type="text" value="'+x+'">\n          </div>\n          <div class="minus"></div>\n        </div>'),$('#contributor .input-block:first-child select').val(s),this.showOptionsBasedOnType()},addSubsequentContributor:function addSubsequentContributor(){var s=0<arguments.length&&arguments[0]!==void 0?arguments[0]:'author',t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:'',u=2<arguments.length&&arguments[2]!==void 0?arguments[2]:'',w=3<arguments.length&&arguments[3]!==void 0?arguments[3]:'',x=4<arguments.length&&arguments[4]!==void 0?arguments[4]:'';$('#contributor .block').append('\n        <div class="input-block">\n          <select name="type">\n            <option class= "author" value="author">Author</option>\n            <option class= "editor" value="editor">Editor</option>\n            <option class= "translator" value="translator">Translator</option>\n          </select>\n          <input class="first" size="1" maxlength="1" type="text" value="'+t+'">\n          <input class="middle" size="1" maxlength="1" type="text" value="'+u+'">\n          <input class="last" type="text" value="'+w+'">\n          <input class="suffix" type="text" value="'+x+'">\n          <div class="minus"></div>\n        </div>'),$('#contributor .input-block:last-child select').val(s),this.showOptionsBasedOnType()},deleteContributor:function deleteContributor(s){if(s.remove(),$(s).is(':first-child')){var t={type:$('#contributor .input-block:first-child').find('select :selected').val(),first:$('#contributor .input-block:first-child').find('.first').val()||'',middle:$('#contributor .input-block:first-child').find('.middle').val()||'',last:$('#contributor .input-block:first-child').find('.last').val()||'',suffix:$('#contributor .input-block:first-child').find('.suffix').val()||''};$('#contributor .input-block:first-child').html('\n          <div>\n            <select name="type">\n              <option class= "author" value="author">Author</option>\n              <option class= "editor" value="editor">Editor</option>\n              <option class= "translator" value="translator">Translator</option>\n            </select>\n          </div>\n          <div>\n            <label>F.I.</label>\n            <input class="first" size="1" maxlength="1" type="text" value="'+t.first+'">\n          </div>\n          <div>\n            <label>M.I.</label>\n            <input class="middle" size="1" maxlength="1" type="text" value="'+t.middle+'">\n          </div>\n          <div>\n            <label>Last Name</label>\n            <input class="last" type="text" value="'+t.last+'">\n          </div>\n          <div>\n            <label>Suffix</label>\n            <input class="suffix" type="text" value="'+t.suffix+'">\n          </div>\n          <div class="minus"></div>'),$('#contributor .input-block:first-child select').val(t.type),this.showOptionsBasedOnType()}},resetWarnings:function resetWarnings(){$('#contributor .error-message').css('visibility','hidden'),$('#contributor input').css('border-bottom','2px solid transparent'),$('#contributor select').css('color','#202020')},default:function _default(){$('#contributor option').hide()},deinit:function deinit(){this.resetWarnings(),this.default()},verify:function verify(){this.resetWarnings();var s=!0;return $('#contributor .input-block').each(function(){var t={type:$(this).find('select :selected').val(),last:$(this).find('.last').val(),first:$(this).find('.first').val(),middle:$(this).find('.middle').val(),suffix:$(this).find('.suffix').val()};-1===g.visibleContributorOptions.indexOf(t.type)&&($(this).find('select').css('color','#f25c32'),s=!1,console.error(Errors.contributorType)),0>=t.last.length&&(0<t.first.length||0<t.middle.length||0<t.suffix.length)?($(this).find('.last').css('border-bottom','2px solid #f25c32'),0>=t.first.length&&($(this).find('.first').css('border-bottom','2px solid #f25c32'),console.error(Errors.contributorFirst)),s=!1,console.error(Errors.contributorLast)):0>=t.first.length&&(0<t.middle.length||0<t.suffix.length||'author'!==t.type&&0<t.last.length)&&($(this).find('.first').css('border-bottom','2px solid #f25c32'),s=!1,console.error(Errors.contributorFirst))}),s},undo:function undo(){App.author=[],App.editor=[],App.translator=[]}},h={log:function log(){var s=0<arguments.length&&void 0!==arguments[0]?arguments[0]:App.type,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:App.subtype,u=2<arguments.length&&void 0!==arguments[2]?arguments[2]:App.sectionTitle,w=3<arguments.length&&void 0!==arguments[3]?arguments[3]:App.sourceTitle,x=4<arguments.length&&void 0!==arguments[4]?arguments[4]:App.periodical,z=5<arguments.length&&void 0!==arguments[5]?arguments[5]:App.date;return('reference'===s||'book'===s&&'chapter'===t)&&(u=$('#section-title input').val()),w=$('#source-title input').val(),Tools.or(s,['journal','newspaper','magazine'])&&(x=$('#periodical input').val()),z=$('#date input[name="year"]').val(),('newspaper'===s||'magazine'===s)&&'n.d.'!==$('#date select').val()&&(z+=', '+$('#date select').val()),('newspaper'===s||'magazine'===s)&&!1!=$('#date input[name="day"]').val()&&(z+=' '+$('#date input[name="day"]').val()),z||(z='n.d.'),{sectionTitle:u,sourceTitle:w,periodical:x,date:z}},init:function init(){var s=0<arguments.length&&arguments[0]!==void 0?arguments[0]:App.type,t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:App.subtype;('reference'===s||'book'===s&&'chapter'===t)&&$('#title-date #section-title').show(),Tools.or(s,['journal','newspaper','magazine'])&&$('#title-date #periodical').show(),('newspaper'===s||'magazine'===s)&&($('#date select[name="month"]').show(),$('#date input[name="day"]').show())},resetWarnings:function resetWarnings(){$('#title-date .error-message').css('visibility','hidden'),$('#title-date input').css('border-bottom','2px solid transparent'),$('#title-date select').css('color','#202020')},default:function _default(){$('#section-title, #periodical').hide(),$('#date select, #date input[name="day"]').hide()},deinit:function deinit(){this.resetWarnings(),this.default()},verify:function verify(){var s=0<arguments.length&&void 0!==arguments[0]?arguments[0]:App.type;this.resetWarnings();var t=!0,u={month:$('#date select :selected').val(),day:$('#date input[name="day"]').val(),year:$('#date input[name="year"]').val()};return('newspaper'===s||'magazine'===s)&&(!App.validateDay(u.month,u.day)&&0<u.day.length&&($('#date input[name="day"]').css('border-bottom','2px solid #f25c32'),t=!1,console.error(Errors.dateInvalidDay)),Tools.or(u.month,['n.d.','Spring','Summer','Fall','Winter'])&&0<u.day.length&&($('#date select').css('color','#f25c32'),t=!1,console.error(Errors.dateNoMonth)),0>=u.year.length&&'n.d.'!==u.month&&($('#date input[name="year"]').css('border-bottom','2px solid #f25c32'),t=!1,console.error(Errors.dateNoYear))),!App.validateYear(u.year)&&0<u.year.length&&($('#date input[name="year"]').css('border-bottom','2px solid #f25c32'),t=!1,console.error(Errors.dateInvalidYear)),$('#title-date .entry:not(#date) input:visible').each(function(){0>=$(this).val().length&&($(this).css('border-bottom','2px solid #f25c32'),t=!1,console.error(Errors.dateNoTitle))}),t},undo:function undo(){App.sectionTitle='',App.sourceTitle='',App.periodical='',App.date='n.d.'}},j={radioLog:function radioLog(){return{stateRadio:$('#publisher input[type="radio"][value="state"]').prop('checked'),doiRadio:$('#doi-url input[type="radio"][value="doi"]').prop('checked')}},log:function log(){var s=0<arguments.length&&void 0!==arguments[0]?arguments[0]:App.publisher,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:App.doi,u=2<arguments.length&&void 0!==arguments[2]?arguments[2]:App.url,w=3<arguments.length&&void 0!==arguments[3]?arguments[3]:App.vol,x=4<arguments.length&&void 0!==arguments[4]?arguments[4]:App.issue,z=5<arguments.length&&void 0!==arguments[5]?arguments[5]:App.ed,A=6<arguments.length&&void 0!==arguments[6]?arguments[6]:App.pp,B=7<arguments.length&&void 0!==arguments[7]?arguments[7]:App.reportNo,C=App.type,D=App.subtype,E=App.format;if('print'===E&&Tools.or(C,['book','reference','report'])){var F=$('#publisher input[name="city"]').val();F+='state'===$('#publisher input[name="location"]:checked').val()?', '+$('#publisher input[name="state"]').val():', '+$('#publisher input[name="country"]').val(),s=F+': '+Tools.checkCapitalization($('#publisher input[name="publisher-name"]').val())}else'digital'===E||'ebook'===E?'doi'===$('#doi-url input[name="doi-url"]:checked').val()?t=$('#doi-url input[name="doi"]').val():u=$('#doi-url input[name="url"]').val():'web'===E&&(u=$('#url input[name="url"]').val());return(Tools.or(C,['book','reference','magazine'])||Tools.or(D,['sp-issue','sp-section','article','abstract']))&&(w=$('#viep input[name="vol"]').val()||w),'book'===C||'reference'===C?z=$('#viep input[name="ed"]').val()||z:'magazine'===C||'sp-issue'===D?x=$('#viep .input-block > div:nth-child(3) input').val()||x:Tools.or(D,['article','abstract','sp-section'])&&(x=$('#viep .input-block > div:nth-child(2) input').val()||x),(Tools.or(D,['article','sp-section','abstract'])||'newspaper'===C||'magazine'===C||'chapter'===D)&&(A=$('#viep input[name="pp"]').val()||A),'report'===C&&(B=$('#report-no input[name="report-no"]').val()||B),{publisher:s,doi:t,url:u,vol:w,issue:x,ed:z,pp:A,reportNo:B}},viepInit:function viepInit(){var s=0<arguments.length&&arguments[0]!==void 0?arguments[0]:App.type,t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:App.subtype,u=2<arguments.length&&arguments[2]!==void 0?arguments[2]:App.format;$('#viep input').css('border-bottom','2px solid transparent'),'book'===s||'reference'===s?$('#viep input[name="vol"], #viep input[name="ed"]').css('border-bottom','2px solid #3e72c4'):('article'===t||'abstract'===t||'sp-section'===t)&&$('#viep .input-block > div:nth-child(2) input').css('border-bottom','2px solid #3e72c4'),('newspaper'===s||'magazine'===s||'chapter'===t||'journal'===s&&'digital'===u)&&$('#viep input[name="pp"]').css('border-bottom','solid 2px #3e72c4')},init:function init(){var s=0<arguments.length&&arguments[0]!==void 0?arguments[0]:App.type,t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:App.subtype,u=2<arguments.length&&arguments[2]!==void 0?arguments[2]:App.format;Tools.or(s,['book','reference','report'])&&'print'===u?($('#publisher').show(),$('#publication .hint').show(),$('#publication .hint-box').html('<p>For the publisher name, omit common terms such as <i>Publishers</i>, <i>Co.</i>, and <i>Inc.</i> Do not omit <i>Books</i> or <i>Press</i>. If author is the publisher, write <i>Author</i> as the publisher name.</p>')):'ebook'===u||'digital'===u?$('#doi-url').show():'web'===u&&$('#url').show(),'advance'!==t&&'webpage'!==s&&'report'!==s&&($('#viep').show(),$('#viep .input-block > div').hide(),'book'===s||'reference'===s?$('#viep .input-block > div:first-child, #viep .input-block > div:nth-child(4)').show():'magazine'===s||'sp-issue'===t?$('#viep .input-block > div:first-child, #viep .input-block > div:nth-child(3)').show():Tools.or(t,['article','abstract','sp-section'])&&($('#viep .input-block > div:first-child, #viep .input-block > div:nth-child(2)').show(),$('#publication .hint').show(),$('#publication .hint-box').html('<p>If each issue of the journal starts on page 1, include the issue. Otherwise, leave the issue blank.</p>')),(Tools.or(t,['article','sp-section','abstract'])||'newspaper'===s||'magazine'===s||'chapter'===t)&&$('#viep .input-block > div:last-child').show()),'report'===s&&$('#report-no').show(),this.viepInit()},resetWarnings:function resetWarnings(){$('#publication .error-message').css('visibility','hidden'),$('#publication input[type="text"]').css('border-bottom','2px solid transparent')},default:function _default(){$('#publication .entry').hide(),$('#publication .hint-box').html(''),$('#publication .hint').hide()},deinit:function deinit(){this.resetWarnings(),this.default()},verify:function verify(){var s=0<arguments.length&&void 0!==arguments[0]?arguments[0]:App.type,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:App.subtype,u=2<arguments.length&&void 0!==arguments[2]?arguments[2]:App.format;this.resetWarnings();var w=!0;if($('#viep').is(':visible')&&this.viepInit(s,t),$('#publisher').is(':visible')&&($('#publisher input[type="text"]:visible').each(function(){0>=$(this).val().length&&($(this).css('border-bottom','2px solid #f25c32'),w=!1,console.error(Errors.publisherIncomplete))}),'state'===$('#publisher input[name="location"]:checked').val())){var z=$('#publisher input[name="state"]').val();-1===['AK','AL','AR','AS','AZ','CA','CO','CT','DC','DE','FL','GA','GU','HI','IA','ID','IL','IN','KS','KY','LA','MA','MD','ME','MI','MN','MO','MS','MT','NC','ND','NE','NH','NJ','NM','NV','NY','OH','OK','OR','PA','PR','RI','SC','SD','TN','TX','UT','VA','VI','VT','WA','WI','WV','WY','AB','BC','MB','NB','NL','NT','NS','NU','ON','PE','QC','SK','YT'].indexOf(z)&&z&&($('#publisher input[name="state"]').css('border-bottom','2px solid #f25c32'),w=!1,console.error(Errors.publisherInvalidState))}return $('#doi-url').is(':visible')&&0>=$('#doi-url input[type="text"]:visible').val().length&&($('#doi-url input[type="text"]:visible').css('border-bottom','2px solid #f25c32'),w=!1,console.error(Errors.doiUrlMissing)),$('#url').is(':visible')&&0>=$('#url input').val().length&&($('#url input').css('border-bottom','2px solid #f25c32'),w=!1,console.error(Errors.urlMissing)),$('#viep').is(':visible')&&($('#viep input:visible').each(function(){'pp'===$(this).attr('name')?!Tools.validateRange($(this).val())&&0<$(this).val().length&&'newspaper'!==s&&($(this).css('border-bottom','2px solid #f25c32'),w=!1,console.error(Errors.viepInvalidPages)):'ed'!==$(this).attr('name')&&!Tools.validateNumber($(this).val())&&0<$(this).val().length&&($(this).css('border-bottom','2px solid #f25c32'),w=!1,console.error(Errors.viepInvalidNumber))}),'book'!==s&&'reference'!==s&&('article'!==t&&'abstract'!==t&&'sp-section'!==t&&$('#viep input[name="issue"]').is(':visible')&&0>=$('#viep input[name="issue"]:visible').val().length&&($('#viep input[name="issue"]').css('border-bottom','2px solid #f25c32'),w=!1,console.error(Errors.viepNoIssue)),$('#viep input[name="vol"]').is(':visible')&&0>=$('#viep input[name="vol"]').val().length&&($('#viep input[name="vol"]').css('border-bottom','2px solid #f25c32'),w=!1,console.error(Errors.viepNoVol))),'journal'===s&&'digital'!==u&&$('#viep input[name="pp"]').is(':visible')&&0>=$('#viep input[name="pp"]').val().length&&($('#viep input[name="pp"]').css('border-bottom','2px solid #f25c32'),w=!1,console.error(Errors.viepNoPages))),w},undo:function undo(){App.publisher='',App.doi='',App.url='',App.vol='',App.issue='',App.ed='',App.pp='',App.reportNo=''}},k={log:function log(){var s=0<arguments.length&&void 0!==arguments[0]?arguments[0]:App.type,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:App.subtype,u=2<arguments.length&&void 0!==arguments[2]?arguments[2]:App.format,w=3<arguments.length&&void 0!==arguments[3]?arguments[3]:App.retrieval,x=4<arguments.length&&void 0!==arguments[4]?arguments[4]:App.ebook,z=5<arguments.length&&void 0!==arguments[5]?arguments[5]:App.website;return'change-true'===t&&(w=$('#retrieval-date select').val()+' '+$('#retrieval-date input[name="day"]').val()+', '+$('#retrieval-date input[name="year"]').val()),'ebook'===u&&(x=$('#ebook-version input[name="version"]').val()),'report'===s&&'digital'===u&&(z=$('#website-name input').val()),{retrieval:w,ebook:x,website:z}},init:function init(){var s=0<arguments.length&&arguments[0]!==void 0?arguments[0]:App.type,t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:App.subtype,u=2<arguments.length&&arguments[2]!==void 0?arguments[2]:App.format;'change-true'===t?($('#retrieval-date').show(),$('#extra .hint').show()):'ebook'===u?$('#ebook-version').show():'report'===s&&'digital'===u&&$('#website-name').show()},setToday:function setToday(){var t=new Date;$('#retrieval-date select').val(function(u){return['January','February','March','April','May','June','July','August','September','October','November','December'][u]}(t.getMonth())),$('#retrieval-date input[name="day"]').val(t.getDate()),$('#retrieval-date input[name="year"]').val(t.getFullYear())},resetWarnings:function resetWarnings(){$('#extra input[type="text"]').css('border-bottom','2px solid transparent'),$('#extra .error-message').css('visibility','hidden')},default:function _default(){$('#extra .hint').hide()},deinit:function deinit(){this.resetWarnings(),this.default()},verify:function verify(){this.resetWarnings();var s=!0;if($('#retrieval-date').is(':visible')){var t={month:$('#retrieval-date select :selected').val(),day:$('#retrieval-date input[name="day"]').val(),year:$('#retrieval-date input[name="year"]').val()};App.validateDay(t.month,t.day)||(s=!1,$('#retrieval-date input[name="day"]').css('border-bottom','2px solid #f25c32'),console.error(Errors.dateInvalidDay)),App.validateYear(t.year)||(s=!1,$('#retrieval-date input[name="year"]').css('border-bottom','2px solid #f25c32'),console.error(Errors.dateInvalidYear))}return $('#ebook-version').is(':visible')&&0>=$('#ebook-version input').val().length&&(s=!1,$('#ebook-version input').css('border-bottom','2px solid #f25c32'),console.error(Errors.ebookEditionMissing)),s},undo:function undo(){App.retrieval='',App.ebook=''}};$('.info').click(function(){e.to('#info'),beforeInfo='#'+$(this).parent().attr('id'),o.updateBefore()}),$('#info .close').click(function(){e.to(beforeInfo)});var l=['APA','About','Version','Settings'];$('#content > div:first-child').show(),$('#tab li:first-child').css('font-weight','400');var n=1;$('#tab li').click(function(){var s=$(this).html(),t=l.indexOf(s)+1;$('#content > div:nth-child('+n+')').hide(),$('#content > div:nth-child('+t+')').show(),$('#tab li:nth-child('+n+')').css('font-weight','100'),$('#tab li:nth-child('+t+')').css('font-weight','400'),n=t,p&&localStorage.setItem('CITEAPA_TAB',n)}),$('.hint').hover(function(){$(this).parent().find('.hint-box').toggle()}),$('.restart').click(function(){confirm('Restart? This will reset your information.')&&(b(),o.resetStorage(),f.default(),g.default(),h.default(),j.default(),k.default(),e.to('#start'))}),$('#start .step').click(function(){e.to('#select')}),$('#select .back').click(function(){e.to('#start')}),$('#select .box:not(:last-child)').click(function(){App.type=$(this).find('h2').html().toLowerCase(),e.to('#second'),beforeSecond='#select',o.updateBefore(),o.logStorage({type:App.type}),f.init(),o.logStorage(f.log())}),$('#select .box:last-child').click(function(){e.to('#other')}),$('#other .back').click(function(){e.to('#select')}),$('#other select').on('change',function(){o.logStorage({other:$(this).val()})}),$('#other .step, #other .forward').click(function(){App.type=$('#other select :selected').val(),e.to('#second'),beforeSecond='#other',o.updateBefore(),o.logStorage({type:App.type}),f.init(),o.logStorage(f.log())}),$('#second .back').click(function(){f.deinit(),App.type='',e.to(beforeSecond)}),$('#second input[type="radio"]').each(function(){$(this).prop('checked',function(){return Tools.or($(this).val(),['print','change-false','entire','article'])})}),$('#second input[type="radio"]').on('change',function(){o.logStorage(f.log())}),$('#second .step, #second .forward').click(function(){f.verify()?(App=Object.assign(App,f.log()),e.to('#contributor'),g.init(),o.logStorage({contributor:g.log()})):$('#second .error-message').css('visibility','visible')}),$('#contributor .back').click(function(){g.deinit(),f.undo(),e.to('#second')}),$('#contributor').on('click','.plus',function(){0==$('#contributor .block').children().length?g.addFirstContributor():g.addSubsequentContributor(),o.logStorage({contributor:g.log()})}),$('#contributor').on('click','.minus',function(){var s=$(this).parent();g.deleteContributor(s),o.logStorage({contributor:g.log()})}),$('#contributor').on('input','.first, .middle',function(){var s=$(this).val().toUpperCase();$(this).val(s)}),$('#contributor').on('change','select',function(){o.logStorage({contributor:g.log()})}),$('#contributor').on('input','input',function(){o.logStorage({contributor:g.log()})}),$('#contributor button, #contributor .forward').click(function(){g.verify()?(g.add(),e.to('#title-date'),h.init(),o.logStorage(h.log())):$('#contributor .error-message').css('visibility','visible')}),$('#title-date .back').click(function(){h.deinit(),g.undo(),e.to('#contributor')}),$('#title-date a').hover(function(){$('#title-date .hint-box').toggle()}),$('#title-date select').on('change',function(){o.logStorage(h.log())}),$('#title-date input').on('input',function(){o.logStorage(h.log())}),$('#title-date .step, #title-date .forward').click(function(){h.verify()?(App=Object.assign(App,h.log()),e.to('#publication'),j.init(),o.logStorage(j.log()),o.logStorage(j.radioLog())):$('#title-date .error-message').css('visibility','visible')}),$('#publication .back').click(function(){j.deinit(),h.undo(),e.to('#title-date')}),$('#publisher input[type="radio"][value="state"]').prop('checked',!0),$('#publisher input[type="radio"][value="international"]').prop('checked',!1),$('#publisher input[type="radio"]').on('change',function(){$('#publisher input[name="state"]').toggle(),$('#publisher input[name="country"]').toggle()}),$('#publisher input[name="state"]').on('input',function(){var s=$(this).val().toUpperCase();$(this).val(s)}),$('#doi-url input[type="radio"][value="doi"]').prop('checked',!0),$('#doi-url input[type="radio"][value="url"]').prop('checked',!1),$('#doi-url input[type="radio"]').on('change',function(){$('#doi-url input[type="text"]').toggle()}),$('#viep a').hover(function(){$('.hint-box').toggle()}),$('#publication input[type="radio"]').on('change',function(){o.logStorage(j.radioLog())}),$('#publication input[type="text"]').on('input',function(){o.logStorage(j.log())}),$('#publication .step, #publication .forward').click(function(){j.verify(App.type,App.subtype,App.format)?(App=Object.assign(App,j.log()),'change-true'===App.subtype||'ebook'===App.format||'report'===App.type&&'digital'===App.format&&'url'===$('#doi-url input[name="doi-url"]:checked').val()?(e.to('#extra'),k.init(),k.log()):(e.to('#annotation'),beforeAnnotation='#publication',o.updateBefore())):$('#publication .error-message').css('visibility','visible')}),$('#extra .back').click(function(){k.deinit(),j.undo(),e.to('#publication')}),k.setToday(),$('#extra select').on('change',function(){o.logStorage(k.log())}),$('#extra input').on('input',function(){o.logStorage(k.log())}),$('#extra .step, #extra .forward').click(function(){k.verify()?(App=Object.assign(App,k.log()),beforeAnnotation='#extra',o.updateBefore(),e.to('#annotation'),o.logStorage({annotation:$('#annotation textarea').val()})):$('#extra .error-message').css('visibility','visible')}),$('#annotation .back').click(function(){e.to(beforeAnnotation),'#publication'==beforeAnnotation?j.undo():k.undo()}),$('#annotation textarea').on('input',function(){o.logStorage({annotation:$('#annotation textarea').val()})}),$('#annotation .step, #annotation .forward').click(function(){App.annotation=$('#annotation textarea').val()||App.annotation,e.to('#result'),$('#citation').html(createCitation())}),$('#result .back').click(function(){if(localStorage.getItem('CITEAPA_SAVED'))if(confirm('Edit your original data? Your manual edits will not be reflected once you go back.'))localStorage.removeItem('CITEAPA_SAVED');else return;App.annotation='',e.to('#annotation')}),$('#result .step:first-child').click(function(){var s=document.getElementById('citation'),t,u;document.createTextRange?(t=document.createTextRange(),t.moveToElementText(s),t.select()):window.getSelection&&(u=window.getSelection(),t=document.createRange(),t.selectNodeContents(s),u.removeAllRanges(),u.addRange(t));try{var w=document.execCommand('copy');w||console.log(Errors.copyUnsuccessful)}catch(x){console.error(Errors.copyUnsuccessful)}window.getSelection?u.removeAllRanges():t.deselect()}),$('#result .step:last-child').click(function(){e.to('#edit');var s=$('#citation').html();$('#edit textarea').val(s),p&&localStorage.setItem('CITEAPA_EDIT',s)}),$('#edit .back').click(function(){e.to('#result'),localStorage.removeItem('CITEAPA_EDIT')}),$('#edit .step').click(function(){e.to('#result');var s=$('#edit textarea').val();$('#citation').html(s),localStorage.setItem('CITEAPA_SAVED',s),p&&localStorage.removeItem('CITEAPA_EDIT')}),$('#edit textarea').on('input',function(){p&&localStorage.setItem('CITEAPA_EDIT',$(this).val())});var o={pages:['#start','#select','#other','#second','#contributor','#title-date','#publication','#extra','#annotation','#result','#edit'],logStorage:function logStorage(s){if(p){var t=JSON.parse(localStorage.getItem('CITEAPA_APP'));t=Object.assign(t,s),localStorage.setItem('CITEAPA_APP',JSON.stringify(t))}},setPage:function setPage(s){p&&localStorage.setItem('CITEAPA_PAGE',s)},resetStorage:function resetStorage(){var s=JSON.stringify(new Preset(!0));s=s.replace(/'/g,'"'),localStorage.setItem('CITEAPA_APP',s),localStorage.removeItem('CITEAPA_PAGE'),localStorage.removeItem('CITEAPA_BEFORE'),localStorage.removeItem('CITEAPA_TAB')},logSettings:function logSettings(s){if(p){var t=JSON.parse(localStorage.getItem('CITEAPA_SETTINGS'));'object'!==('undefined'==typeof t?'undefined':_typeof(t))&&(t={}),t=Object.assign(t,s),localStorage.setItem('CITEAPA_SETTINGS',JSON.stringify(t))}},updateBefore:function updateBefore(){p&&localStorage.setItem('CITEAPA_BEFORE',JSON.stringify({info:beforeInfo,second:beforeSecond,annotation:beforeAnnotation}))}},p;(function(){if(b(),'false'===localStorage.getItem('CITEAPA_SAVE'))return p=!1,void(localStorage.getItem('CITEAPA_APP')&&localStorage.removeItem('CITEAPA_APP'));if(localStorage.setItem('CITEAPA_SAVE','true'),p=!0,localStorage.getItem('CITEAPA_SETTINGS')){var t=JSON.parse(localStorage.getItem('CITEAPA_SETTINGS'));t.hasOwnProperty('fontType')&&($('#citation').css('font-family',t.fontType+', Arial'),$('#font-type').val(t.fontType)),t.hasOwnProperty('fontSize')&&($('#citation').css('font-size',t.fontSize+'pt'),$('#font-size').val(t.fontSize))}if(!localStorage.getItem('CITEAPA_APP'))o.resetStorage();else if(function(){var B=JSON.parse(localStorage.getItem('CITEAPA_APP'));if(B.type)App.type=B.type;else return;if($('#other select').val(B.other),B.subtype||B.format)$('#second .entry').each(function(){var I=-1;$(this).find('input[type="radio"]').each(function(J){($(this).val()===B.subtype||$(this).val()===B.format)&&(I=J)}),-1<I&&$(this).find('input[type="radio"]').each(function(J){$(this).prop('checked',I===J)})});else return;if(0<B.contributor.length){g.deleteContributor($('#contributor .input-block'));var C=B.contributor;if(g.addFirstContributor(C[0].type,C[0].first,C[0].middle,C[0].last,C[0].suffix),1<C.length)for(var D=1;D<C.length;D++)g.addSubsequentContributor(C[D].type,C[D].first,C[D].middle,C[D].last,C[D].suffix)}if(B.sectionTitle&&$('#section-title input').val(B.sectionTitle),B.sourceTitle&&$('#source-title input').val(B.sourceTitle),B.periodical&&$('#periodical input').val(B.periodical),B.date){var E=B.date.split(' ');-1===E.indexOf('n.d.')&&(E[0]=','===E[0].slice(-1)?E[0].slice(0,-1):E[0],$('#date input[name="year"]').val(E[0])),E[1]&&2<E[1].length?$('#date select').val(E[1]):E[1]&&$('#date input[name="day"]').val(E[1]),E[2]&&$('#date input[name="day"]').val(E[2])}if(B.publisher){var F=B.publisher.split(': ');$('#publisher input[name="publisher-name"]').val(F[1]);var G=F[0].split(', ');$('#publisher input[name="city"]').val(G[0]),B.stateRadio&&2>=G[1].length?$('#publisher input[name="state"]').val(G[1]):($('#publisher input[name="country"]').val(G[1]),$('#publisher input[type="radio"]').prop('checked',function(){return!$(this).prop('checked')}),$('#publisher input[name="state"]').toggle(),$('#publisher input[name="country"]').toggle())}if('digital'===B.format||'ebook'===B.format?(B.doi&&$('#doi-url input[name="doi"]').val(B.doi),B.url&&$('#doi-url input[name="url"]').val(B.url),!B.doiRadio&&($('#doi-url input[type="radio"]').prop('checked',function(){return!$(this).prop('checked')}),$('#doi-url input[type="text"]').toggle())):B.url&&$('#url input').val(B.url),B.vol&&$('#viep input[name="vol"]').val(B.vol),B.issue&&$('#viep input[name="issue"]').val(B.issue),B.ed&&$('#viep input[name="ed"]').val(B.ed),B.pp&&$('#viep input[name="pp"]').val(B.pp),B.reportNo&&$('#report-no input[name="report-no"]').val(B.reportNo),B.retrieval){var H=B.retrieval.split(' ');$('#retrieval-date select').val(H[0]),H[1]&&2>=H[1].length?$('#retrieval-date input[name="day"]').val(H[1].slice(0,-1)):2===H.length&&$('#retrieval-date input[name="year"]').val(H[1]),H[2]&&$('#retrieval-date input[name="year"]').val(H[2])}B.ebook&&$('#ebook-version input').val(B.ebook),B.website&&$('#website-name input').val(B.website),B.annotation&&$('#annotation textarea').val(B.annotation)}(),!localStorage.getItem('CITEAPA_BEFORE'))o.updateBefore();else{var z=function(A){if(2<A&&(f.init(),3<A&&(App=Object.assign(App,f.log()),g.init(),4<A&&(g.add(),h.init(),5<A&&(App=Object.assign(App,h.log()),j.init(),6<A&&(App=Object.assign(App,j.log()),'#extra'==beforeAnnotation&&k.init(),7<A&&('#extra'==beforeAnnotation&&(App=Object.assign(App,k.log())),8<A))))))){App.annotation=$('#annotation textarea').val()||App.annotation;var B=localStorage.getItem('CITEAPA_SAVED');if(B?$('#citation').html(B):$('#citation').html(createCitation()),9<A){var C=localStorage.getItem('CITEAPA_EDIT');C?$('#edit textarea').val(C):$('#edit textarea').val($('#citation').html())}}},u=JSON.parse(localStorage.getItem('CITEAPA_BEFORE'));beforeInfo=u.info,beforeSecond=u.second,beforeAnnotation=u.annotation;var w=localStorage.getItem('CITEAPA_PAGE'),x=o.pages.indexOf(w);if('#info'===w)2<o.pages.indexOf(beforeInfo)&&10>=o.pages.indexOf(beforeInfo)&&z(o.pages.indexOf(beforeInfo)),e.to('#info');else{if(0>x||10<x)return;if(0===x);else 2>=x?e.to(w):(z(x),e.to(w))}}})();var q=localStorage.getItem('CITEAPA_TAB');p&&q&&($('#content > div:nth-child('+n+')').hide(),$('#content > div:nth-child('+q+')').show(),$('#tab li:nth-child('+n+')').css('font-weight','100'),$('#tab li:nth-child('+q+')').css('font-weight','400'),n=q),$('#content > div:last-child input[name="autosave"]').prop('checked',function(){return p}),$('#content > div:last-child input[name="autosave"]').on('change',function(){p=$(this).prop('checked'),localStorage.setItem('CITEAPA_SAVE',p),p&&(console.log('Autosave initiated. Logging necessary info...'),o.logStorage({type:App.type}),o.logStorage(f.log()),o.logStorage({contributor:g.log()}),o.logStorage(h.log()),o.logStorage(j.log()),o.logStorage(k.log()),o.logStorage({annotation:$('#annotation textarea').val()}),localStorage.setItem('CITEAPA_PAGE','#info'),o.updateBefore())}),$('#content > div:last-child button').click(function(){o.resetStorage()}),$('#font-type').on('change',function(){$('#citation').css('font-family',$(this).val()+', Arial'),o.logSettings({fontType:$(this).val()})}),$('#font-size').on('change',function(){var s=+$(this).val();isNaN(s)||0>=s||($('#citation').css('font-size',s+'pt'),o.logSettings({fontSize:s}))})});